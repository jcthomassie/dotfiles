#!/usr/bin/env zsh
INIT_DIR=$(pwd)

cd $HOME
echo "Updating yadm and submodules"
yadm pull --rebase --autostash origin master
yadm submodule update --remote
cd $INIT_DIR

case $OSTYPE in
    darwin*)
        echo "Updating OSX via yadm"
        brew update && brew upgrade
        brew cleanup
        ;;

    linux*)
        echo "Updating Linux via yadm"
        for PM in apt-get apt yum; do
            if command -v $PM &> /dev/null; then
                sudo $PM update && sudo $PM upgrade
            fi
        done
        ;;

    *)
        echo "Update not configured for OS: $OSTYPE"
        ;;
esac
